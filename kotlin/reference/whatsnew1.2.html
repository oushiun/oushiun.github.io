<!DOCTYPE html>
<html  lang="en">
<head>
    <meta charset="utf-8">
<title>Kotlin 1.2 的新特性 - oushiun</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />



    <meta name="description" content="多平台项目（实验性的）多平台项目是 Kotlin 1.2 中的一个新的实验性的功能，允许你在支持 Kotlin 的目标平台——JVM、JavaScript 以及（将来的）Native 之间重用代码。在多平台项目中，你有三种模块：  一个公共模块包含平台无关代码，以及无实现的依赖平台的 API 声明。 平台模块包含通用模块中的平台相关声明在指定平台的实现，以及其他平台相关代码。 常规模块针对指定的平">
<meta name="keywords" content="Kotlin">
<meta property="og:type" content="article">
<meta property="og:title" content="Kotlin 1.2 的新特性">
<meta property="og:url" content="http://oushiun.com/kotlin/reference/whatsnew1.2.html">
<meta property="og:site_name" content="oushiun">
<meta property="og:description" content="多平台项目（实验性的）多平台项目是 Kotlin 1.2 中的一个新的实验性的功能，允许你在支持 Kotlin 的目标平台——JVM、JavaScript 以及（将来的）Native 之间重用代码。在多平台项目中，你有三种模块：  一个公共模块包含平台无关代码，以及无实现的依赖平台的 API 声明。 平台模块包含通用模块中的平台相关声明在指定平台的实现，以及其他平台相关代码。 常规模块针对指定的平">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2019-01-18T04:34:30.897Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Kotlin 1.2 的新特性">
<meta name="twitter:description" content="多平台项目（实验性的）多平台项目是 Kotlin 1.2 中的一个新的实验性的功能，允许你在支持 Kotlin 的目标平台——JVM、JavaScript 以及（将来的）Native 之间重用代码。在多平台项目中，你有三种模块：  一个公共模块包含平台无关代码，以及无实现的依赖平台的 API 声明。 平台模块包含通用模块中的平台相关声明在指定平台的实现，以及其他平台相关代码。 常规模块针对指定的平">





<link rel="icon" href="/images/favicon.png">


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/rainbow.min.css">


    
    
    
    <style>body>.footer,body>.navbar,body>.section{opacity:0}</style>
    

    
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css">
    

    
    

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.css">


    
    
    
    

<link rel="stylesheet" href="/css/back-to-top.css">


    
    
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-65562224-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-65562224-1');
</script>


    
    
    
    

    
    
<link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>

    


<link rel="stylesheet" href="/css/style.css">
</head>
<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo.png" alt="Kotlin 1.2 的新特性" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item"
                href="/">Home</a>
                
                <a class="navbar-item"
                href="/archives">Archives</a>
                
                <a class="navbar-item"
                href="/categories">Categories</a>
                
                <a class="navbar-item"
                href="/tags">Tags</a>
                
                <a class="navbar-item"
                href="/about">About</a>
                
            </div>
            
            <div class="navbar-end">
                
                    
                    
                    <a class="navbar-item" target="_blank" title="Download on GitHub" href="https://github.com/oushiun/oushiun.github.io">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                    
                
                
                <a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;">
                    <i class="fas fa-list-ul"></i>
                </a>
                
                
                <a class="navbar-item search" title="Search" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-8-widescreen has-order-2 column-main"><div class="card">
    
    <div class="card-image">
        <span  class="image is-7by1">
            <img class="thumbnail" src="https://static.oushiun.com/blog/banner/Kotlin.png" alt="Kotlin 1.2 的新特性">
        </span>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2018-05-15T04:15:24.000Z">2018-05-15</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/后端/">后端</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/后端/Kotlin/">Kotlin</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/后端/Kotlin/参考/">参考</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/后端/Kotlin/参考/概述/">概述</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    25 minutes read (About 3697 words)
                </span>
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                Kotlin 1.2 的新特性
            
        </h1>
        <div class="content">
            <h2 id="多平台项目（实验性的）"><a href="#多平台项目（实验性的）" class="headerlink" title="多平台项目（实验性的）"></a>多平台项目（实验性的）</h2><p>多平台项目是 Kotlin 1.2 中的一个新的<strong>实验性的</strong>功能，允许你在支持 Kotlin 的目标平台——JVM、JavaScript 以及（将来的）Native 之间重用代码。在多平台项目中，你有三种模块：</p>
<ul>
<li>一个<em>公共</em>模块包含平台无关代码，以及无实现的依赖平台的 API 声明。</li>
<li><em>平台</em>模块包含通用模块中的平台相关声明在指定平台的实现，以及其他平台相关代码。</li>
<li>常规模块针对指定的平台，既可以是平台模块的依赖，也可以依赖平台模块。</li>
</ul>
<a id="more"></a>
<p>当你为指定平台编译多平台项目时，既会生成公共代码也会生成平台相关代码。</p>
<p>多平台项目支持的一个主要特点是可以通过<strong>预期声明与实际声明</strong>来表达公共代码对平台相关部分的依赖关系。一个预期声明指定一个 API（类、接口、注解、顶层声明等）。一个实际声明要么是该 API 的平台相关实现，要么是一个引用到在一个外部库中该 API 的一个既有实现的别名。这是一个示例：</p>
<p>在公共代码中：</p>
<figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// 预期平台相关 API:</span></span><br><span class="line">expect <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">hello</span><span class="hljs-params">(world: <span class="hljs-type">String</span>)</span></span>: String</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">greet</span><span class="hljs-params">()</span></span> &#123;</span><br><span class="line">    <span class="hljs-comment">// 该预期 API 的用法：</span></span><br><span class="line">    <span class="hljs-keyword">val</span> greeting = hello(<span class="hljs-string">"multi-platform world"</span>)</span><br><span class="line">    println(greeting)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">expect <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">URL</span></span>(spec: String) &#123;</span><br><span class="line">    <span class="hljs-keyword">open</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getHost</span><span class="hljs-params">()</span></span>: String</span><br><span class="line">    <span class="hljs-keyword">open</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getPath</span><span class="hljs-params">()</span></span>: String</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在 JVM 平台代码中：</p>
<figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">actual <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">hello</span><span class="hljs-params">(world: <span class="hljs-type">String</span>)</span></span>: String =</span><br><span class="line">    <span class="hljs-string">"Hello, <span class="hljs-variable">$world</span>, on the JVM platform!"</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// 使用既有平台相关实现：</span></span><br><span class="line">actual typealias URL = java.net.URL</span><br></pre></td></tr></table></figure>
<p>关于构建多平台项目的详细信息与步骤，请参见其<a href="http://kotlinlang.org/docs/reference/multiplatform.html" target="_blank" rel="noopener">documentation</a>。</p>
<h2 id="其他语言特性"><a href="#其他语言特性" class="headerlink" title="其他语言特性"></a>其他语言特性</h2><h3 id="注解中的数组字面值"><a href="#注解中的数组字面值" class="headerlink" title="注解中的数组字面值"></a>注解中的数组字面值</h3><p>自 Kotlin 1.2 起，注解的数组参数可以通过新的数组字面值语法传入，而无需使用 <code>arrayOf</code> 函数：</p>
<figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">@CacheConfig(cacheNames = [<span class="hljs-meta-string">"books"</span>, <span class="hljs-meta-string">"default"</span>])</span></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BookRepositoryImpl</span> </span>&#123;</span><br><span class="line">    <span class="hljs-comment">// ……</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>该数组字面值语法仅限于注解参数。</p>
<h3 id="lateinit-顶层属性与局部变量"><a href="#lateinit-顶层属性与局部变量" class="headerlink" title="lateinit 顶层属性与局部变量"></a>lateinit 顶层属性与局部变量</h3><p><code>lateinit</code> 修饰符现在可以用于顶层属性与局部变量了。例如，后者可用于当一个 lambda 表达式作为构造函数参数传给一个对象时，引用另一个必须稍后定义的对象：</p>
<figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Node</span>&lt;<span class="hljs-type">T</span>&gt;</span>(<span class="hljs-keyword">val</span> value: T, <span class="hljs-keyword">val</span> next: () -&gt; Node&lt;T&gt;)</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">(args: <span class="hljs-type">Array</span>&lt;<span class="hljs-type">String</span>&gt;)</span></span> &#123;</span><br><span class="line">    <span class="hljs-comment">//sampleStart</span></span><br><span class="line">    <span class="hljs-comment">// 三个节点的环：</span></span><br><span class="line">    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> third: Node&lt;<span class="hljs-built_in">Int</span>&gt;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">val</span> second = Node(<span class="hljs-number">2</span>, next = &#123; third &#125;)</span><br><span class="line">    <span class="hljs-keyword">val</span> first = Node(<span class="hljs-number">1</span>, next = &#123; second &#125;)</span><br><span class="line"></span><br><span class="line">    third = Node(<span class="hljs-number">3</span>, next = &#123; first &#125;)</span><br><span class="line">    <span class="hljs-comment">//sampleEnd</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">val</span> nodes = generateSequence(first) &#123; it.next() &#125;</span><br><span class="line">    println(<span class="hljs-string">"Values in the cycle: <span class="hljs-subst">$&#123;nodes.take(<span class="hljs-number">7</span>).joinToString &#123; it.value.toString() &#125;</span>&#125;, ..."</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="检查-lateinit-变量是否已初始化"><a href="#检查-lateinit-变量是否已初始化" class="headerlink" title="检查 lateinit 变量是否已初始化"></a>检查 lateinit 变量是否已初始化</h3><p>现在可以通过属性引用的 <code>isInitialized</code> 来检测该 lateinit var 是否已初始化：</p>
<figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> lateinitVar: String</span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">initializationLogic</span><span class="hljs-params">()</span></span> &#123;</span><br><span class="line">        <span class="hljs-comment">//sampleStart</span></span><br><span class="line">        println(<span class="hljs-string">"isInitialized before assignment: "</span> + <span class="hljs-keyword">this</span>::lateinitVar.isInitialized)</span><br><span class="line">        lateinitVar = <span class="hljs-string">"value"</span></span><br><span class="line">        println(<span class="hljs-string">"isInitialized after assignment: "</span> + <span class="hljs-keyword">this</span>::lateinitVar.isInitialized)</span><br><span class="line">        <span class="hljs-comment">//sampleEnd</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">(args: <span class="hljs-type">Array</span>&lt;<span class="hljs-type">String</span>&gt;)</span></span> &#123;</span><br><span class="line">	Foo().initializationLogic()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="内联函数带有默认函数式参数"><a href="#内联函数带有默认函数式参数" class="headerlink" title="内联函数带有默认函数式参数"></a>内联函数带有默认函数式参数</h3><p>内联函数现在允许其内联函式数参数具有默认值：</p>
<figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">//sampleStart</span></span><br><span class="line"><span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;E&gt;</span> Iterable<span class="hljs-type">&lt;E&gt;</span>.<span class="hljs-title">strings</span><span class="hljs-params">(transform: (<span class="hljs-type">E</span>)</span></span> -&gt; String = &#123; it.toString() &#125;) =</span><br><span class="line">    map &#123; transform(it) &#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">val</span> defaultStrings = listOf(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>).strings()</span><br><span class="line"><span class="hljs-keyword">val</span> customStrings = listOf(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>).strings &#123; <span class="hljs-string">"(<span class="hljs-variable">$it</span>)"</span> &#125;</span><br><span class="line"><span class="hljs-comment">//sampleEnd</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">(args: <span class="hljs-type">Array</span>&lt;<span class="hljs-type">String</span>&gt;)</span></span> &#123;</span><br><span class="line">    println(<span class="hljs-string">"defaultStrings = <span class="hljs-variable">$defaultStrings</span>"</span>)</span><br><span class="line">    println(<span class="hljs-string">"customStrings = <span class="hljs-variable">$customStrings</span>"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="源自显式类型转换的信息会用于类型推断"><a href="#源自显式类型转换的信息会用于类型推断" class="headerlink" title="源自显式类型转换的信息会用于类型推断"></a>源自显式类型转换的信息会用于类型推断</h3><p>Kotlin 编译器现在可将类型转换信息用于类型推断。如果你调用一个返回类型参数 <code>T</code> 的泛型方法并将返回值转换为指定类型 <code>Foo</code>，那么编译器现在知道对于本次调用需要绑定类型为 <code>Foo</code>。</p>
<p>这对于 Android 开发者来说尤为重要，因为编译器现在可以正确分析 Android API 级别 26 中的泛型 <code>findViewById</code> 调用：</p>
<figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">val</span> button = findViewById(R.id.button) <span class="hljs-keyword">as</span> Button</span><br></pre></td></tr></table></figure>
<h3 id="智能类型转换改进"><a href="#智能类型转换改进" class="headerlink" title="智能类型转换改进"></a>智能类型转换改进</h3><p>当一个变量有安全调用表达式与空检测赋值时，其智能转换现在也可以应用于安全调用接收者：</p>
<figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">countFirst</span><span class="hljs-params">(s: <span class="hljs-type">Any</span>)</span></span>: <span class="hljs-built_in">Int</span> &#123;</span><br><span class="line">    <span class="hljs-comment">//sampleStart</span></span><br><span class="line">    <span class="hljs-keyword">val</span> firstChar = (s <span class="hljs-keyword">as</span>? CharSequence)?.firstOrNull()</span><br><span class="line">    <span class="hljs-keyword">if</span> (firstChar != <span class="hljs-literal">null</span>)</span><br><span class="line">       <span class="hljs-keyword">return</span> s.count &#123; it == firstChar &#125; <span class="hljs-comment">// s: Any 会智能转换为 CharSequence</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">val</span> firstItem = (s <span class="hljs-keyword">as</span>? Iterable&lt;*&gt;)?.firstOrNull()</span><br><span class="line">    <span class="hljs-keyword">if</span> (firstItem != <span class="hljs-literal">null</span>)</span><br><span class="line">       <span class="hljs-keyword">return</span> s.count &#123; it == firstItem &#125; <span class="hljs-comment">// s: Any 会智能转换为 Iterable&lt;*&gt;</span></span><br><span class="line">    <span class="hljs-comment">//sampleEnd</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">(args: <span class="hljs-type">Array</span>&lt;<span class="hljs-type">String</span>&gt;)</span></span> &#123;</span><br><span class="line">    <span class="hljs-keyword">val</span> string = <span class="hljs-string">"abacaba"</span></span><br><span class="line">    <span class="hljs-keyword">val</span> countInString = countFirst(string)</span><br><span class="line">    println(<span class="hljs-string">"called on \"<span class="hljs-variable">$string</span>\": <span class="hljs-variable">$countInString</span>"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">val</span> list = listOf(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>)</span><br><span class="line">    <span class="hljs-keyword">val</span> countInList = countFirst(list)</span><br><span class="line">    println(<span class="hljs-string">"called on <span class="hljs-variable">$list</span>: <span class="hljs-variable">$countInList</span>"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>智能转换现在也允许用于在 lambda 表达式中局部变量，只要这些局部变量仅在 lambda 表达式之前修改即可：</p>
<figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">(args: <span class="hljs-type">Array</span>&lt;<span class="hljs-type">String</span>&gt;)</span></span> &#123;</span><br><span class="line">    <span class="hljs-keyword">val</span> flag = args.size == <span class="hljs-number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">//sampleStart</span></span><br><span class="line">    <span class="hljs-keyword">var</span> x: String? = <span class="hljs-literal">null</span></span><br><span class="line">    <span class="hljs-keyword">if</span> (flag) x = <span class="hljs-string">"Yahoo!"</span></span><br><span class="line"></span><br><span class="line">    run &#123;</span><br><span class="line">        <span class="hljs-keyword">if</span> (x != <span class="hljs-literal">null</span>) &#123;</span><br><span class="line">            println(x.length) <span class="hljs-comment">// x 会智能转换为 String</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-comment">//sampleEnd</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="支持-foo-作为-this-foo-的简写"><a href="#支持-foo-作为-this-foo-的简写" class="headerlink" title="支持 ::foo 作为 this::foo 的简写"></a>支持 ::foo 作为 this::foo 的简写</h3><p>现在写绑定到 <code>this</code> 成员的可调用引用可以无需显式接收者，即 <code>::foo</code> 取代 <code>this:: foo</code>。这也使在引用外部接收者的成员的 lambda 表达式中使用可调用引用更加方便。</p>
<h3 id="阻断性变更：try-块后可靠智能转换"><a href="#阻断性变更：try-块后可靠智能转换" class="headerlink" title="阻断性变更：try 块后可靠智能转换"></a>阻断性变更：try 块后可靠智能转换</h3><p>Kotlin 以前将 <code>try</code> 块中的赋值语句用于块后的智能转换，这可能会破坏类型安全与空安全并引发运行时故障。这个版本修复了该问题，使智能转换更加严格，但可能会破坏一些依靠这种智能转换的代码。</p>
<p>如果要切换到旧版智能转换行为，请传入回退标志 <code>-Xlegacy-smart-cast-after-try</code> 作为编译器参数。该参数会在 Kotlin 1.3 中弃用。</p>
<h3 id="弃用：数据类弃用-copy"><a href="#弃用：数据类弃用-copy" class="headerlink" title="弃用：数据类弃用 copy"></a>弃用：数据类弃用 copy</h3><p>当从已具有签名相同的 <code>copy</code> 函数的类型派生数据类时，为数据类生成的 <code>copy</code> 实现使用超类型的默认值，这导致反直觉行为，或者导致运行时失败，如果超类型中没有默认参数的话。</p>
<p>导致 <code>copy</code> 冲突的继承在 Kotlin 1.2 中已弃用并带有警告，而在 Kotlin 1.3 中将会是错误。</p>
<h3 id="弃用：枚举条目中的嵌套类型"><a href="#弃用：枚举条目中的嵌套类型" class="headerlink" title="弃用：枚举条目中的嵌套类型"></a>弃用：枚举条目中的嵌套类型</h3><p>由于初始化逻辑的问题，已弃用在枚举条目内部定义一个非 <code>inner class</code> 的嵌套类。这在 Kotlin 1.2 中会引起警告，而在 Kotlin 1.3 中会成为错误。</p>
<h3 id="弃用：vararg-单个命名参数"><a href="#弃用：vararg-单个命名参数" class="headerlink" title="弃用：vararg 单个命名参数"></a>弃用：vararg 单个命名参数</h3><p>为了与注解中的数组字面值保持一致，向一个命名参数形式的 vararg 参数传入单个项目的用法（<code>foo(items = i)</code>）已被弃用。请使用伸展操作符连同相应的数组工厂函数：</p>
<figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">foo(items = *intArrayOf(<span class="hljs-number">1</span>))</span><br></pre></td></tr></table></figure>
<p>在这种情况下有一项防止性能下降的优化可以消除冗余的数组创建。单参数形式在 Kotlin 1.2 中会产生警告，而在 Kotlin 1.3 中会放弃。</p>
<h3 id="弃用：扩展-Throwable-的泛型类的内部类"><a href="#弃用：扩展-Throwable-的泛型类的内部类" class="headerlink" title="弃用：扩展 Throwable 的泛型类的内部类"></a>弃用：扩展 Throwable 的泛型类的内部类</h3><p>继承自 <code>Throwable</code> 的泛型类的内部类可能会在 throw-catch 场景中违反类型安全性，因此已弃用，在 Kotlin 1.2 中会是警告，而在 Kotlin 1.3 中会是错误。</p>
<h3 id="弃用：修改只读属性的幕后字段"><a href="#弃用：修改只读属性的幕后字段" class="headerlink" title="弃用：修改只读属性的幕后字段"></a>弃用：修改只读属性的幕后字段</h3><p>通过在自定义 getter 中赋值 <code>field = ……</code> 来修改只读属性的幕后字段的用法已被弃用，在 Kotlin 1.2 中会是警告，而在 Kotlin 1.3 中会是错误。</p>
<h2 id="标准库"><a href="#标准库" class="headerlink" title="标准库"></a>标准库</h2><h3 id="Kotlin-标准库构件与拆分包"><a href="#Kotlin-标准库构件与拆分包" class="headerlink" title="Kotlin 标准库构件与拆分包"></a>Kotlin 标准库构件与拆分包</h3><p>Kotlin 标准库现在完全兼容 Java 9 的模块系统，它禁止拆分包（多个 jar 文件声明的类在同一包中）。为了支持这点，我们引入了新的 <code>kotlin-stdlib-jdk7</code> 与 <code>kotlin-stdlib-jdk8</code>，它们取代了旧版的 <code>kotlin-stdlib-jre7</code> 与 <code>kotlin-stdlib-jre8</code>。</p>
<p>在 Kotlin 看来新的构件中的声明在相同的包名内，而在 Java 看来有不同的包名。因此，切换到新的构件无需修改任何源代码。</p>
<p>确保与新的模块系统兼容的另一处变更是在 <code>kotlin-reflect</code> 库中删除了 <code>kotlin.reflect</code> 包中弃用的声明。如果你正在使用它们，你需要切换到使用 <code>kotlin.reflect.full</code> 包中的声明，自 Kotlin 1.1 起就支持这个包了。</p>
<h3 id="windowed、chunked、zipWithNext"><a href="#windowed、chunked、zipWithNext" class="headerlink" title="windowed、chunked、zipWithNext"></a>windowed、chunked、zipWithNext</h3><p>用于 <code>Iterable&lt;T&gt;</code>、 <code>Sequence&lt;T&gt;</code> 与 <code>CharSequence</code> 的新的扩展覆盖了这些应用场景：缓存或批处理（<code>chunked</code>）、 滑动窗口与计算滑动均值（<code>windowed</code>）以及处理成对的后续条目（<code>zipWithNext</code>）：</p>
<figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">(args: <span class="hljs-type">Array</span>&lt;<span class="hljs-type">String</span>&gt;)</span></span> &#123;</span><br><span class="line">    <span class="hljs-comment">//sampleStart</span></span><br><span class="line">    <span class="hljs-keyword">val</span> items = (<span class="hljs-number">1.</span><span class="hljs-number">.9</span>).map &#123; it * it &#125;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">val</span> chunkedIntoLists = items.chunked(<span class="hljs-number">4</span>)</span><br><span class="line">    <span class="hljs-keyword">val</span> points3d = items.chunked(<span class="hljs-number">3</span>) &#123; (x, y, z) -&gt; Triple(x, y, z) &#125;</span><br><span class="line">    <span class="hljs-keyword">val</span> windowed = items.windowed(<span class="hljs-number">4</span>)</span><br><span class="line">    <span class="hljs-keyword">val</span> slidingAverage = items.windowed(<span class="hljs-number">4</span>) &#123; it.average() &#125;</span><br><span class="line">    <span class="hljs-keyword">val</span> pairwiseDifferences = items.zipWithNext &#123; a, b -&gt; b - a &#125;</span><br><span class="line">    <span class="hljs-comment">//sampleEnd</span></span><br><span class="line"></span><br><span class="line">    println(<span class="hljs-string">"items: <span class="hljs-variable">$items</span>\n"</span>)</span><br><span class="line"></span><br><span class="line">    println(<span class="hljs-string">"chunked into lists: <span class="hljs-variable">$chunkedIntoLists</span>"</span>)</span><br><span class="line">    println(<span class="hljs-string">"3D points: <span class="hljs-variable">$points3d</span>"</span>)</span><br><span class="line">    println(<span class="hljs-string">"windowed by 4: <span class="hljs-variable">$windowed</span>"</span>)</span><br><span class="line">    println(<span class="hljs-string">"sliding average by 4: <span class="hljs-variable">$slidingAverage</span>"</span>)</span><br><span class="line">    println(<span class="hljs-string">"pairwise differences: <span class="hljs-variable">$pairwiseDifferences</span>"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="fill、replaceAll、shuffle-shuffled"><a href="#fill、replaceAll、shuffle-shuffled" class="headerlink" title="fill、replaceAll、shuffle/shuffled"></a>fill、replaceAll、shuffle/shuffled</h3><p>添加了一些用于操作列表的扩展函数：<code>MutableList</code> 的 <code>fill</code>、<code>replaceAll</code> 与 <code>shuffle</code>，以及只读 <code>List</code> 的 <code>shuffled</code>：</p>
<figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">(args: <span class="hljs-type">Array</span>&lt;<span class="hljs-type">String</span>&gt;)</span></span> &#123;</span><br><span class="line">    <span class="hljs-comment">//sampleStart</span></span><br><span class="line">    <span class="hljs-keyword">val</span> items = (<span class="hljs-number">1.</span><span class="hljs-number">.5</span>).toMutableList()</span><br><span class="line"></span><br><span class="line">    items.shuffle()</span><br><span class="line">    println(<span class="hljs-string">"Shuffled items: <span class="hljs-variable">$items</span>"</span>)</span><br><span class="line"></span><br><span class="line">    items.replaceAll &#123; it * <span class="hljs-number">2</span> &#125;</span><br><span class="line">    println(<span class="hljs-string">"Items doubled: <span class="hljs-variable">$items</span>"</span>)</span><br><span class="line"></span><br><span class="line">    items.fill(<span class="hljs-number">5</span>)</span><br><span class="line">    println(<span class="hljs-string">"Items filled with 5: <span class="hljs-variable">$items</span>"</span>)</span><br><span class="line">    <span class="hljs-comment">//sampleEnd</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="kotlin-stdlib-中的数学运算"><a href="#kotlin-stdlib-中的数学运算" class="headerlink" title="kotlin-stdlib 中的数学运算"></a>kotlin-stdlib 中的数学运算</h3><p>为满足由来已久的需求，Kotlin 1.2 添加了 JVM 与 JS 公用的用于数学运算的 <code>kotlin.math</code> API，包含以下内容：</p>
<ul>
<li>常量：<code>PI</code> 与 <code>E</code>；</li>
<li>三角函数：<code>cos</code>、 <code>sin</code>、 <code>tan</code> 及其反函数：<code>acos</code>、 <code>asin</code>、 <code>atan</code>、 <code>atan2</code>；</li>
<li>双曲函数：<code>cosh</code>、 <code>sinh</code>、 <code>tanh</code> 及其反函数：<code>acosh</code>、 <code>asinh</code>、 <code>atanh</code></li>
<li>指数函数：<code>pow</code>（扩展函数）、 <code>sqrt</code>、 <code>hypot</code>、 <code>exp</code>、 <code>expm1</code>；</li>
<li>对数函数：<code>log</code>、 <code>log2</code>、 <code>log10</code>、 <code>ln</code>、 <code>ln1p</code>；</li>
<li>取整:<ul>
<li><code>ceil</code>、 <code>floor</code>、 <code>truncate</code>、 <code>round</code>（奇进偶舍）函数；</li>
<li><code>roundToInt</code>、 <code>roundToLong</code>（四舍五入）扩展函数；</li>
</ul>
</li>
<li>符号与绝对值：<ul>
<li><code>abs</code> 与 <code>sign</code> 函数；</li>
<li><code>absoluteValue</code> 与 <code>sign</code> 扩展属性；</li>
<li><code>withSign</code> 扩展函数；</li>
</ul>
</li>
<li>两个数的最值函数：<code>max</code> 与 <code>min</code>；</li>
<li>二进制表示：<ul>
<li><code>ulp</code> 扩展属性；</li>
<li><code>nextUp</code>、 <code>nextDown</code>、 <code>nextTowards</code> 扩展函数；</li>
<li><code>toBits</code>、 <code>toRawBits</code>、 <code>Double.fromBits</code>（这些在 <code>kotlin</code> 包中）。</li>
</ul>
</li>
</ul>
<p>这些函数同样也有 <code>Float</code> 参数版本（但不包括常量）。</p>
<h3 id="用于-BigInteger-与-BigDecimal-的操作符与转换"><a href="#用于-BigInteger-与-BigDecimal-的操作符与转换" class="headerlink" title="用于 BigInteger 与 BigDecimal 的操作符与转换"></a>用于 BigInteger 与 BigDecimal 的操作符与转换</h3><p>Kotlin 1.2 引入了一些使用 <code>BigInteger</code> 与 <code>BigDecimal</code> 运算以及由其他数字类型创建它们的函数。具体如下：</p>
<ul>
<li><code>toBigInteger</code> 用于 <code>Int</code> 与 <code>Long</code>；</li>
<li><code>toBigDecimal</code> 用于 <code>Int</code>、 <code>Long</code>、 <code>Float</code>、 <code>Double</code> 以及 <code>BigInteger</code>；</li>
<li>算术与位运算操作符函数：<ul>
<li>二元操作符 <code>+</code>、 <code>-</code>、 <code>*</code>、 <code>/</code>、 <code>%</code> 以及中缀函数 <code>and</code>、 <code>or</code>、 <code>xor</code>、 <code>shl</code>、 <code>shr</code>；</li>
<li>一元操作符 <code>-</code>、 <code>++</code>、 <code>--</code> 以及函数 <code>inv</code>。</li>
</ul>
</li>
</ul>
<h3 id="浮点数到比特的转换"><a href="#浮点数到比特的转换" class="headerlink" title="浮点数到比特的转换"></a>浮点数到比特的转换</h3><p>添加了用于将 <code>Double</code> 及 <code>Float</code> 与其比特表示形式相互转换的函数：</p>
<ul>
<li><code>toBits</code> 与 <code>toRawBits</code> 对于 <code>Double</code> 返回 <code>Long</code> 而对于 <code>Float</code> 返回 <code>Int</code>；</li>
<li><code>Double.fromBits</code> 与 <code>Float.fromBits</code> 用于有相应比特表示形式创建浮点数。</li>
</ul>
<h3 id="正则表达式现在可序列化"><a href="#正则表达式现在可序列化" class="headerlink" title="正则表达式现在可序列化"></a>正则表达式现在可序列化</h3><p><code>kotlin.text.Regex</code> 类现在已经是 <code>Serializable</code> 的了并且可用在可序列化的继承结构中。</p>
<h3 id="如果可用，Closeable-use-会调用-Throwable-addSuppressed"><a href="#如果可用，Closeable-use-会调用-Throwable-addSuppressed" class="headerlink" title="如果可用，Closeable.use 会调用 Throwable.addSuppressed"></a>如果可用，Closeable.use 会调用 Throwable.addSuppressed</h3><p>当在其他异常之后关闭资源期间抛出一个异常，<code>Closeable.use</code> 函数会调用 <code>Throwable.addSuppressed</code><br>。</p>
<p>要启用这个行为，需要依赖项中有 <code>kotlin-stdlib-jdk7</code>。</p>
<h2 id="JVM-后端"><a href="#JVM-后端" class="headerlink" title="JVM 后端"></a>JVM 后端</h2><h3 id="构造函数调用规范化"><a href="#构造函数调用规范化" class="headerlink" title="构造函数调用规范化"></a>构造函数调用规范化</h3><p>自 1.0 版起，Kotlin 就已支持带有复杂控制流的表达式，诸如 try-catch 表达式以及内联函数。根据 Java 虚拟机规范这样的代码是有效的。不幸的是，当这样的表达式出现在构造函数调用的参数中时，一些字节码处理工具不能很好地处理这种代码。</p>
<p>为了缓解这种字节码处理工具用户的这一问题，我们添加了一个命令行选项（<code>-Xnormalize-constructor-calls=模式</code>），告诉编译器为这样的构造过程生成更接近 Java 的字节码。其中<code>模式</code>是下列之一：</p>
<ul>
<li><code>disable</code>（默认）——以与 Kotlin 1.0 即 1.1 相同的方式生成字节码；</li>
<li><code>enable</code>——为构造函数调用生成类似 Java 的字节码。 这可能会改变类加载与初始化的顺序；</li>
<li><code>preserve-class-initialization</code>——为构造函数调用生成类似 Java 的字节码，并确保类初始化顺序得到保留。这可能会影响应用程序的整体性能；仅用在多个类之间共享一些复杂状态并在类初始化时更新的场景中。</li>
</ul>
<p>“人工”解决办法是将具有控制流的子表达式的值存储在变量中，而不是直接在调用参数内对其求值。这与 <code>-Xnormalize-constructor-calls=enable</code> 类似。</p>
<h3 id="Java-默认方法调用"><a href="#Java-默认方法调用" class="headerlink" title="Java 默认方法调用"></a>Java 默认方法调用</h3><p>在 Kotlin 1.2 之前，针对 JVM 1.6 的接口成员覆盖 Java 默认方法会产生一个关于超类型调用的警告：<code>Super calls to Java default methods are deprecated in JVM target 1.6. Recompile with &#39;-jvm-target 1.8&#39;</code>（“针对 JVM 1.6 的 Java 默认方法的超类型调用已弃用，请使用‘-jvm-target 1.8’重新编译”）。在 Kotlin 1.2 中，这是一个<strong>错误 </strong>，因此这样的代码都需要针对 JVM 1.8 编译。</p>
<h3 id="阻断性变更：平台类型-x-equals-null-的一致行为"><a href="#阻断性变更：平台类型-x-equals-null-的一致行为" class="headerlink" title="阻断性变更：平台类型 x.equals(null) 的一致行为"></a>阻断性变更：平台类型 x.equals(null) 的一致行为</h3><p>在映射到 Java 原生类型（<code>Int!</code>、 <code>Boolean!</code>、 <code>Short!</code>、 <code>Long!</code>、 <code>Float!</code>、 <code>Double!</code>、 <code>Char!</code>）的平台类型上调用 <code>x.equals(null)</code>，当 <code>x</code> 为 <code>null</code> 时错误地返回了 <code>true</code>。自 Kotlin 1.2 起，在平台类型的空值上调用 <code>x.equals(……)</code> 都会<strong>抛出 NPE</strong> （但 <code>x == ...</code> 不会）。</p>
<p>要返回到 1.2 之前的行为，请将标志 <code>-Xno-exception-on-explicit-equals-for-boxed-null</code> 传给编译器。</p>
<h3 id="阻断性变更：修正平台-null-透过内联扩展接收者逃逸"><a href="#阻断性变更：修正平台-null-透过内联扩展接收者逃逸" class="headerlink" title="阻断性变更：修正平台 null 透过内联扩展接收者逃逸"></a>阻断性变更：修正平台 null 透过内联扩展接收者逃逸</h3><p>在平台类型的空值上调用内联扩展函数并没有检测接收者是否为 null，因而允许 null 逃逸到其他代码中。Kotlin 1.2 在调用处强制执行这项检测，如果接收者为空就抛出异常。</p>
<p>要切换到旧版行为，请将回退标志 <code>-Xno-receiver-assertions</code> 传给编译器。</p>
<h2 id="JavaScript-后端"><a href="#JavaScript-后端" class="headerlink" title="JavaScript 后端"></a>JavaScript 后端</h2><h3 id="默认启用-TypedArrays-支持"><a href="#默认启用-TypedArrays-支持" class="headerlink" title="默认启用 TypedArrays 支持"></a>默认启用 TypedArrays 支持</h3><p>将 Kotlin 原生数组（如 <code>IntArray</code>、 <code>DoubleArray</code> 等）翻译为 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Typed_arrays" target="_blank" rel="noopener">JavaScript 有类型数组</a>的 JS 有类型数组支持之前是选择性加入的功能，现在已默认启用。</p>
<h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><h3 id="警告作为错误"><a href="#警告作为错误" class="headerlink" title="警告作为错误"></a>警告作为错误</h3><p>编译器现在提供一个将所有警告视为错误的选项。可在命令行中使用 <code>-Werror</code>，或者在 Gradle 中使用以下代码片段：</p>
<figure class="highlight groovy hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">compileKotlin &#123;</span><br><span class="line">    kotlinOptions.allWarningsAsErrors = <span class="hljs-literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

        </div>
        
        <div class="level is-size-7 is-uppercase">
            <div class="level-start">
                <div class="level-item">
                    <span class="is-size-6 has-text-grey has-mr-7">#</span>
                    <a class="has-link-grey -link" href="/tags/Kotlin/">Kotlin</a>
                </div>
            </div>
        </div>
        
        
        
        
<div class="addthis_inline_share_toolbox"></div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-546ef3c21741bbff"></script>

        
    </div>
</div>





<div class="card card-transparent">
    <div class="level post-navigation is-flex-wrap is-mobile">
        
        <div class="level-start">
            <a class="level level-item has-link-grey  article-nav-prev" href="/kotlin/reference/basic-syntax.html">
                <i class="level-item fas fa-chevron-left"></i>
                <span class="level-item">基本语法</span>
            </a>
        </div>
        
        
        <div class="level-end">
            <a class="level level-item has-link-grey  article-nav-next" href="/kotlin/reference/whatsnew1.1.html">
                <span class="level-item">Kotlin 1.1 的新特性</span>
                <i class="level-item fas fa-chevron-right"></i>
            </a>
        </div>
        
    </div>
</div>



<div class="card">
    <div class="card-content">
        <h3 class="title is-5 has-text-weight-normal">Comments</h3>
        
<div id="valine-thread"></div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='//unpkg.com/valine/dist/Valine.min.js'></script>
<script>
    new Valine({
        el: '#valine-thread' ,
        notify: false,
        verify: false,
        app_id: '9Emj4MVh8yl2FtTqbIkFQhJL-gzGzoHsz',
        app_key: 'w9XrTYkAAeSp1xQk9QvtpSSz',
        placeholder: '留下你想说的话吧 (๑•ᴗ•๑)'
    });
</script>

    </div>
</div>
</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered">
                <div>
                    <img class="image is-128x128 has-mb-6" src="https://static.oushiun.com/avatar.png" alt="oushiun">
                    
                    <p class="is-size-4 is-block">
                        oushiun
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        Web Developer &amp; PM
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>Hefei, China</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Posts
                    </p>
                    <p class="title has-text-weight-normal">
                        76
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Categories
                    </p>
                    <p class="title has-text-weight-normal">
                        20
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Tags
                    </p>
                    <p class="title has-text-weight-normal">
                        11
                    </p>
                </div>
            </div>
        </nav>
        <div class="level">
            <a class="level-item button is-link is-rounded" href="https://github.com/oushiun">
                Follow</a>
        </div>
        
        
        <div class="level is-mobile">
            
            <a class="level-item button is-white is-marginless" target="_blank"
                title="Github" href="https://github.com/oushiun">
                
                <i class="fab fa-github"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank"
                title="Paypal" href="https://www.paypal.me/oushiun">
                
                <i class="fab fa-paypal"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank"
                title="Steam" href="https://steamcommunity.com/profiles/76561198218709653">
                
                <i class="fab fa-steam"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank"
                title="RSS" href="/">
                
                <i class="fas fa-rss"></i>
                
            </a>
            
        </div>
        
    </div>
</div>
    
        
<div class="card widget" id="toc">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Catalogue
            </h3>
            <ul class="menu-list"><li>
        <a class="is-flex" href="#多平台项目（实验性的）">
        <span class="has-mr-6">1</span>
        <span>多平台项目（实验性的）</span>
        </a></li><li>
        <a class="is-flex" href="#其他语言特性">
        <span class="has-mr-6">2</span>
        <span>其他语言特性</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#注解中的数组字面值">
        <span class="has-mr-6">2.1</span>
        <span>注解中的数组字面值</span>
        </a></li><li>
        <a class="is-flex" href="#lateinit-顶层属性与局部变量">
        <span class="has-mr-6">2.2</span>
        <span>lateinit 顶层属性与局部变量</span>
        </a></li><li>
        <a class="is-flex" href="#检查-lateinit-变量是否已初始化">
        <span class="has-mr-6">2.3</span>
        <span>检查 lateinit 变量是否已初始化</span>
        </a></li><li>
        <a class="is-flex" href="#内联函数带有默认函数式参数">
        <span class="has-mr-6">2.4</span>
        <span>内联函数带有默认函数式参数</span>
        </a></li><li>
        <a class="is-flex" href="#源自显式类型转换的信息会用于类型推断">
        <span class="has-mr-6">2.5</span>
        <span>源自显式类型转换的信息会用于类型推断</span>
        </a></li><li>
        <a class="is-flex" href="#智能类型转换改进">
        <span class="has-mr-6">2.6</span>
        <span>智能类型转换改进</span>
        </a></li><li>
        <a class="is-flex" href="#支持-foo-作为-this-foo-的简写">
        <span class="has-mr-6">2.7</span>
        <span>支持 ::foo 作为 this::foo 的简写</span>
        </a></li><li>
        <a class="is-flex" href="#阻断性变更：try-块后可靠智能转换">
        <span class="has-mr-6">2.8</span>
        <span>阻断性变更：try 块后可靠智能转换</span>
        </a></li><li>
        <a class="is-flex" href="#弃用：数据类弃用-copy">
        <span class="has-mr-6">2.9</span>
        <span>弃用：数据类弃用 copy</span>
        </a></li><li>
        <a class="is-flex" href="#弃用：枚举条目中的嵌套类型">
        <span class="has-mr-6">2.10</span>
        <span>弃用：枚举条目中的嵌套类型</span>
        </a></li><li>
        <a class="is-flex" href="#弃用：vararg-单个命名参数">
        <span class="has-mr-6">2.11</span>
        <span>弃用：vararg 单个命名参数</span>
        </a></li><li>
        <a class="is-flex" href="#弃用：扩展-Throwable-的泛型类的内部类">
        <span class="has-mr-6">2.12</span>
        <span>弃用：扩展 Throwable 的泛型类的内部类</span>
        </a></li><li>
        <a class="is-flex" href="#弃用：修改只读属性的幕后字段">
        <span class="has-mr-6">2.13</span>
        <span>弃用：修改只读属性的幕后字段</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#标准库">
        <span class="has-mr-6">3</span>
        <span>标准库</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#Kotlin-标准库构件与拆分包">
        <span class="has-mr-6">3.1</span>
        <span>Kotlin 标准库构件与拆分包</span>
        </a></li><li>
        <a class="is-flex" href="#windowed、chunked、zipWithNext">
        <span class="has-mr-6">3.2</span>
        <span>windowed、chunked、zipWithNext</span>
        </a></li><li>
        <a class="is-flex" href="#fill、replaceAll、shuffle-shuffled">
        <span class="has-mr-6">3.3</span>
        <span>fill、replaceAll、shuffle/shuffled</span>
        </a></li><li>
        <a class="is-flex" href="#kotlin-stdlib-中的数学运算">
        <span class="has-mr-6">3.4</span>
        <span>kotlin-stdlib 中的数学运算</span>
        </a></li><li>
        <a class="is-flex" href="#用于-BigInteger-与-BigDecimal-的操作符与转换">
        <span class="has-mr-6">3.5</span>
        <span>用于 BigInteger 与 BigDecimal 的操作符与转换</span>
        </a></li><li>
        <a class="is-flex" href="#浮点数到比特的转换">
        <span class="has-mr-6">3.6</span>
        <span>浮点数到比特的转换</span>
        </a></li><li>
        <a class="is-flex" href="#正则表达式现在可序列化">
        <span class="has-mr-6">3.7</span>
        <span>正则表达式现在可序列化</span>
        </a></li><li>
        <a class="is-flex" href="#如果可用，Closeable-use-会调用-Throwable-addSuppressed">
        <span class="has-mr-6">3.8</span>
        <span>如果可用，Closeable.use 会调用 Throwable.addSuppressed</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#JVM-后端">
        <span class="has-mr-6">4</span>
        <span>JVM 后端</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#构造函数调用规范化">
        <span class="has-mr-6">4.1</span>
        <span>构造函数调用规范化</span>
        </a></li><li>
        <a class="is-flex" href="#Java-默认方法调用">
        <span class="has-mr-6">4.2</span>
        <span>Java 默认方法调用</span>
        </a></li><li>
        <a class="is-flex" href="#阻断性变更：平台类型-x-equals-null-的一致行为">
        <span class="has-mr-6">4.3</span>
        <span>阻断性变更：平台类型 x.equals(null) 的一致行为</span>
        </a></li><li>
        <a class="is-flex" href="#阻断性变更：修正平台-null-透过内联扩展接收者逃逸">
        <span class="has-mr-6">4.4</span>
        <span>阻断性变更：修正平台 null 透过内联扩展接收者逃逸</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#JavaScript-后端">
        <span class="has-mr-6">5</span>
        <span>JavaScript 后端</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#默认启用-TypedArrays-支持">
        <span class="has-mr-6">5.1</span>
        <span>默认启用 TypedArrays 支持</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#工具">
        <span class="has-mr-6">6</span>
        <span>工具</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#警告作为错误">
        <span class="has-mr-6">6.1</span>
        <span>警告作为错误</span>
        </a></li></ul></li></ul>
        </div>
    </div>
</div>

    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Categories
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/categories/其他/">
            <span class="level-start">
                <span class="level-item">其他</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/前端/">
            <span class="level-start">
                <span class="level-item">前端</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">10</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/前端/Css3/">
            <span class="level-start">
                <span class="level-item">Css3</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/前端/JavaScript/">
            <span class="level-start">
                <span class="level-item">JavaScript</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">8</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/后端/">
            <span class="level-start">
                <span class="level-item">后端</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">61</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/后端/Kotlin/">
            <span class="level-start">
                <span class="level-item">Kotlin</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">61</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/工具/">
            <span class="level-start">
                <span class="level-item">工具</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/软件/">
            <span class="level-start">
                <span class="level-item">软件</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li>
            </ul>
        </div>
    </div>
</div>
    
    
        <!-- <div class="column-right-shadow is-hidden-widescreen "> -->
        <div class="column-right-shadow  ">
        
            
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Recent
        </h3>
        
        <article class="media">
            
            <a href="/es6/let-const.html" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://static.oushiun.com/blog/banner/let-const.png" alt="let 和 const 命令">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-06-22T04:28:29.000Z">2018-06-22</time></div>
                    <a href="/es6/let-const.html" class="has-link-black-ter is-size-6">let 和 const 命令</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/前端/">前端</a> / <a class="has-link-grey -link" href="/categories/前端/JavaScript/">JavaScript</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/es6/default-rest-spread.html" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://static.oushiun.com/blog/banner/default-rest-spread.jpg" alt="默认参数、不定参数、扩展运算符">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-06-20T03:02:29.000Z">2018-06-20</time></div>
                    <a href="/es6/default-rest-spread.html" class="has-link-black-ter is-size-6">默认参数、不定参数、扩展运算符</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/前端/">前端</a> / <a class="has-link-grey -link" href="/categories/前端/JavaScript/">JavaScript</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/es6/destructuring.html" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://static.oushiun.com/blog/banner/destructuring.jpg" alt="解构">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-06-19T08:07:48.000Z">2018-06-19</time></div>
                    <a href="/es6/destructuring.html" class="has-link-black-ter is-size-6">解构</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/前端/">前端</a> / <a class="has-link-grey -link" href="/categories/前端/JavaScript/">JavaScript</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/es6/template-strings.html" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://static.oushiun.com/blog/banner/es6.jpeg" alt="模板字符串">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-06-14T02:38:35.000Z">2018-06-14</time></div>
                    <a href="/es6/template-strings.html" class="has-link-black-ter is-size-6">模板字符串</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/前端/">前端</a> / <a class="has-link-grey -link" href="/categories/前端/JavaScript/">JavaScript</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/css3/css-coding-standard.html" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://static.oushiun.com/blog/banner/css-coding-standard.jpg" alt="CSS 书写规范">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-06-13T11:51:56.000Z">2018-06-13</time></div>
                    <a href="/css3/css-coding-standard.html" class="has-link-black-ter is-size-6">CSS 书写规范</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/前端/">前端</a> / <a class="has-link-grey -link" href="/categories/前端/Css3/">Css3</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>

        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Archives
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2018/06/">
                <span class="level-start">
                    <span class="level-item">June 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">9</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/05/">
                <span class="level-start">
                    <span class="level-item">May 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">67</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
        
            
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Tag Cloud
        </h3>
        <a href="/tags/BBR/" style="font-size: 10px;">BBR</a> <a href="/tags/Box-Model/" style="font-size: 10px;">Box Model</a> <a href="/tags/CentOS/" style="font-size: 13.33px;">CentOS</a> <a href="/tags/ES6/" style="font-size: 16.67px;">ES6</a> <a href="/tags/Hexo/" style="font-size: 10px;">Hexo</a> <a href="/tags/JavaScript/" style="font-size: 10px;">JavaScript</a> <a href="/tags/Kotlin/" style="font-size: 20px;">Kotlin</a> <a href="/tags/Markdown/" style="font-size: 10px;">Markdown</a> <a href="/tags/jetbrains/" style="font-size: 10px;">jetbrains</a> <a href="/tags/shadowsocks/" style="font-size: 10px;">shadowsocks</a> <a href="/tags/规范/" style="font-size: 10px;">规范</a>
    </div>
</div>

        
        </div>
    
</div>

                <!--  -->
            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="/images/logo.png" alt="Kotlin 1.2 的新特性" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2019 oushiun&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a
                        href="http://github.com/ppoffice/hexo-theme-icarus">Icarus</a>
                </p>
            </div>
            <div class="level-end">
            
                <div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle">
                
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Cloud Servers" href="https://www.vultr.com/?ref=7415455">
                        
                        <i class="fab fa-cloudversify"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Intellij License Server" href="http://idea.oushiun.com/">
                        
                        <i class="fas fa-server"></i>
                        
                    </a>
                </p>
                
                </div>
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script>
<script>moment.locale("en");</script>


    
    
    
    <script src="/js/animation.js"></script>
    

    
    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/js/lightgallery.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script>
    <script src="/js/gallery.js" defer></script>
    

    
    

<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {matchFontHeight: false},
        SVG: {matchFontHeight: false},
        CommonHTML: {matchFontHeight: false}
    });
});
</script>

    
    

<a id="back-to-top" title="Back to Top" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>


    
    

    
    
    
    

    
    
    


<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>
</html>